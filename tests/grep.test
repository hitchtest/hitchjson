{% for python_version in python_versions %}
- name: Grep JSON
  preconditions:
    python_version: {{ python_version }}
    variables:
      buried_text_dict: |
        {
            "a": 4,
            "b": 2,
            "c": 3,
            "x": {
                "somekéy": "a long piece of text with buried string"
            }
        }
      buried_text_list: |
        [
            1,
            2,
            {
                "é": [
                    1,
                    2,
                    "buriéd text"
                ],
                "b": 1,
                "c": 3
            }
        ]
      results_dict: |
        ['x']['somekéy']: "a long piece of text with buried string"
      results_list: |
        [2]['é'][2]: "buriéd text"
  tags:
    - py{{ python_version }}
  scenario:
    - Run command: |
        from hitchjson import grep
        from json import loads

    - Assert True: grep(buried_text_dict, "buried") == results_dict.strip()

    - Assert True: grep(loads(buried_text_dict), "buried") == results_dict.strip()

    - Assert True: grep(buried_text_list, "buriéd") == results_list.strip()

    - Assert True: grep(loads(buried_text_list), "buriéd") == results_list.strip()
{% endfor %}
